#!/usr/bin/env bash

set -eux

export COMPONENT=zookeeper

export conf="${SNAP_DATA}"/etc/$COMPONENT
export logs="${SNAP_COMMON}"/var/lib/$COMPONENT
export data="${SNAP_COMMON}"/var/log/$COMPONENT
export binaries="${SNAP}"/opt/$COMPONENT

mkdir -p $conf
mkdir -p $logs
mkdir -p $data
mkdir -p $binaries

cp "${SNAP}"/log4j.properties $conf
cp -rL "${SNAP}"/usr/lib/jvm/ $binaries
cp "${SNAP}"/jmx_prometheus_javaagent.jar $binaries
cp "${SNAP}"/jmx_prometheus.yaml $conf

chmod -R 770 "${SNAP_DATA}"/*
chmod -R 770 "${SNAP}"/*
chmod -R 770 "${SNAP_COMMON}"/*

chown -R snap_daemon "${SNAP_DATA}"/*
chown -R snap_daemon "${SNAP}"/*
chown -R snap_daemon "${SNAP_COMMON}"/*
